# -*- coding: utf-8 -*-
"""Copy_of_UX_backend_design_py.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/github/ustab/-DATA-SCIENCE-TEMEL-DERSLER/blob/main/Copy_of_UX_backend_design_py.ipynb

ğŸ The Handover

UÃ§tan uca bu iÅŸlemi bitirdiÄŸimde ÅŸu dosyayÄ± vereceÄŸiz:

Frontend: KullanÄ±cÄ± dostu, 432Hz ses Ã§Ä±kÄ±ÅŸlÄ± web/mobil uygulama.
AI Engine: Python ile yazÄ±lmÄ±ÅŸ yÃ¼z ve frekans analiz motoru.
Database: SQL tabanlÄ± seans kayÄ±t ve raporlama sistemi.
Admin Panel: Hastane yÃ¶netiminin (KayÄ±tlÄ± Hastane Ä°sminle) hastalarÄ±n genel iyileÅŸme grafiklerini gÃ¶rebileceÄŸi bir dashboard.

ğŸš€Yol HaritasÄ±:

5 ana katman bitirilecek

1. Frontend (The Interface)ArayÃ¼z: React veya Flutter (Ã‡apraz platform iÃ§in).Kamera Entegrasyonu: KullanÄ±cÄ±nÄ±n yÃ¼zÃ¼nÃ¼ anlÄ±k olarak tarayan modÃ¼l.Dil DesteÄŸi: MÃ¼ÅŸterinin istediÄŸi tÃ¼m dillerde (TÃ¼rkÃ§e, Ä°ngilizce ve diÄŸerleri) dinamik yapÄ±.
2. Backend - Python/FastAPI (The Brain)Logic: Az Ã¶nce yazdÄ±ÄŸÄ±mÄ±z Python kodunun sunucuda (Heroku, AWS veya Azure) Ã§alÄ±ÅŸÄ±r hali.AI Model: YÃ¼z verisini alÄ±p anxious veya depressed etiketini basacak hafif bir model (Ã–rn: DeepFace kÃ¼tÃ¼phanesi).Biosonology Parser: Gelen $432Hz$ gibi verileri analiz eden algoritma.
3. Database & Storage (The Memory)KayÄ±t: KullanÄ±cÄ±nÄ±n seans geÃ§miÅŸini (Hangi gÃ¼n hangi makamÄ± dinledi, stres skoru neydi) tutan veritabanÄ±.Hospital Branding: Hastane isminin (kaydettiÄŸimiz ÅŸekilde) tÃ¼m reÃ§etelerde ve raporlarda gÃ¶rÃ¼nmesi.
4. Physical Integration (The Multisensory Output)Musiki Player: MakamlarÄ± 432Hz kalitesinde Ã§alan ses modÃ¼lÃ¼.Aroma Trigger: (SimÃ¼le edilmiÅŸ veya gerÃ§ek) Koku makinesine sinyal gÃ¶nderen API tetikleyicisi.
5.Databse
ğŸ—„ï¸ EVEYES 360: VeritabanÄ± Mimarisi (PostgreSQL/SQLAlchemy)
MÃ¼ÅŸterine "Verileriniz bu yapÄ±da, gÃ¼venli ve iliÅŸkisel olarak tutuluyor" diyerek sunabileceÄŸin teknik ÅŸema ÅŸudur:

1. KullanÄ±cÄ± Tablosu (Users Table)
HastanÄ±n temel bilgilerini ve daha Ã¶nce kaydettiÄŸimiz Dil SeÃ§eneklerini tutar.
user_id: Unique ID (Birincil Anahtar)
full_name: Hasta AdÄ±
preferred_language: KullanÄ±cÄ±nÄ±n seÃ§tiÄŸi dil (TR, EN, vs.)
hospital_name: [Saved Hospital Name] (Marka bÃ¼tÃ¼nlÃ¼ÄŸÃ¼ iÃ§in)
2. Seans Verileri (Sessions Table)
Her terapi seansÄ±nÄ±n "End-to-End" kaydÄ±dÄ±r.
session_id: UUID
user_id: (User tablosuna baÄŸlÄ±)
ai_mood_result: Kamera analizinden gelen sonuÃ§ (anxious, depressed)
biosonology_frequency: HÃ¼cresel frekans verisi
applied_makam: Uygulanan SelÃ§uklu MakamÄ±
applied_aroma: Ã–nerilen ve kullanÄ±lan koku (Leylak, GÃ¼l vb.)
pre_stress_score: Seans Ã¶ncesi stres puanÄ±
post_stress_score: Seans sonrasÄ± (kullanÄ±cÄ±nÄ±n girdiÄŸi veya AI'nÄ±n Ã¶lÃ§tÃ¼ÄŸÃ¼) yeni puan
"""

from fastapi import FastAPI
from pydantic import BaseModel
from typing import Optional

app = FastAPI()
# Frontend'den gelecek veri yapÄ±sÄ± (Data Schema)
class HealthData(BaseModel):
    frequency: float
    facialMood: Optional[str] = None
    manualMoodScore: Optional[int] = None

@app.post("/api/v1/analyze-condition")
async def analyze_condition(data: HealthData):
    final_stress = 0

    # 1. AI YÃ¼z Analizi MantÄ±ÄŸÄ±
    if data.facialMood == "anxious":
        final_stress = 85
    elif data.facialMood == "depressed":
        final_stress = 90

    # 2. KullanÄ±cÄ± BeyanÄ± (Manuel giriÅŸ varsa AI verisini gÃ¼nceller/geÃ§er)
    if data.manualMoodScore is not None:
        final_stress = data.manualMoodScore

    # 3. Musiki Engine: Karar MekanizmasÄ±
    result = {
        "makam": "Rast",
        "scent": "Rose",
        "instruction": "Standard balance mode activated."
    }

    if final_stress > 75:
        result = {
            "makam": "Saba",
            "scent": "Lilac",
            "instruction": "High stress/anxiety detected. Activating Saba MakamÄ± & Lilac."
        }
    elif data.frequency < 432:
        result = {
            "makam": "Rehavi",
            "scent": "Sandalwood",
            "instruction": "Low energy detected. Rehavi MakamÄ± will restore focus."
        }

    return {"status": "success", "data": result}

from sqlalchemy import Column, Integer, String, Float, ForeignKey, DateTime
from sqlalchemy.ext.declarative import declarative_base
import datetime

Base = declarative_base()

class TherapySession(Base):
    __tablename__ = "therapy_sessions"

    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"))
    ai_mood = Column(String)  # AI'nÄ±n yÃ¼z analiz sonucu
    frequency = Column(Float) # Biosonology verisi
    selected_makam = Column(String) # SeÃ§ilen ÅŸifa makamÄ±
    scent = Column(String) # EÅŸleÅŸen koku
    stress_reduction_rate = Column(Float) # BaÅŸarÄ± oranÄ±
    created_at = Column(DateTime, default=datetime.datetime.utcnow)

# MÃ¼ÅŸteriye sunarken: "Her seans milisaniyelik hassasiyetle kaydedilir."

{
  "hospital_name": "Åehir Hastanesi",
  "patient_data": "Hasta Verileri",
  "bia_analysis": "BIA Analizi (Ã–dem Durumu)",
  "therapy_suggestion": "Ã–nerilen Makam ve Koku"
}

# TÃ¼m dilleri kapsayan veri yapÄ±sÄ±
translations = {
    "tr": {
        "welcome": "HoÅŸ geldiniz",
        "phase_angle": "Faz AÃ§Ä±sÄ±",
        "biosonology": "Biyosonoloji",
        "seljuk_therapy": "SelÃ§uklu MÃ¼zik Terapi"
    },
    "en": {
        "welcome": "Welcome",
        "phase_angle": "Phase Angle",
        "biosonology": "Biosonology",
        "seljuk_therapy": "Seljuk Music Psychotherapy"
    },
    "ar": {
        "welcome": "Ù…Ø±Ø­Ø¨Ø§Ù‹",
        "phase_angle": "Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø·ÙˆØ±",
        "biosonology": "Ø¹Ù„Ù… Ø§Ù„Ø¨ÙŠÙˆØ³ÙˆÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§",
        "seljuk_therapy": "Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø¨Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ÙÙŠ Ø§Ù„Ø¹ØµØ± Ø§Ù„Ø³Ù„Ø¬ÙˆÙ‚ÙŠ"
    }
}

# KullanÄ±cÄ±nÄ±n seÃ§tiÄŸi dil (Dinamik olarak deÄŸiÅŸebilir)
current_lang = "tr"

def get_translation(key):
    """
    Belirtilen anahtarÄ±n Ã§evirisini dÃ¶ndÃ¼rÃ¼r.
    EÄŸer dil veya anahtar bulunamazsa, hata vermek yerine anahtarÄ±n adÄ±nÄ± dÃ¶ndÃ¼rÃ¼r.
    """
    return translations.get(current_lang, {}).get(key, key)

# KullanÄ±m Ã–rnekleri
print(f"BaÅŸlÄ±k: {get_translation('welcome')}")
print(f"Teknik Terim: {get_translation('phase_angle')}")

import json

# Bu yapÄ± veritabanÄ±ndan (PostgreSQL/JSONB) Ã§ekilmiÅŸ gibi simÃ¼le edilmiÅŸtir
therapy_data = {
    "hicaz_desc": {
        "tr": "Hicaz makamÄ± Ã¶dem atar ve boÅŸaltÄ±m sistemini dengeler.",
        "en": "Hicaz maqam reduces edema and balances the excretory system.",
        "ru": "Ğ¥Ğ¸Ğ´Ğ¶Ğ°Ğ· Ğ¼Ğ°ĞºĞ°Ğ¼ ÑƒĞ¼ĞµĞ½ÑŒÑˆĞ°ĞµÑ‚ Ğ¾Ñ‚ĞµĞºĞ¸ Ğ¸ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ¸Ñ€ÑƒĞµÑ‚ Ğ²Ñ‹Ğ´ĞµĞ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ.",
        "ar": "Ù…Ù‚Ø§Ù… Ø§Ù„Ø­Ø¬Ø§Ø² ÙŠÙ‚Ù„Ù„ Ù…Ù† Ø§Ù„ÙˆØ°Ù…Ø© ÙˆÙŠÙˆØ§Ø²Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ÙŠ."
    },
    "lavender_oil": {
        "tr": "Lavanta yaÄŸÄ± kortizolÃ¼ dÃ¼ÅŸÃ¼rerek hÃ¼cresel Ã¶demi azaltÄ±r.",
        "en": "Lavender oil reduces cellular edema by lowering cortisol.",
        "ar": "Ø²ÙŠØª Ø§Ù„Ù„Ø§ÙÙ†Ø¯Ø± ÙŠÙ‚Ù„Ù„ Ù…Ù† Ø§Ù„ÙˆØ°Ù…Ø© Ø§Ù„Ø®Ù„ÙˆÙŠØ© Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø®ÙØ¶ Ø§Ù„ÙƒÙˆØ±ØªÙŠØ²ÙˆÙ„."
    }
}

def get_description(data_key, lang="tr"):
    # Ä°lgili anahtarÄ±n seÃ§ilen dildeki karÅŸÄ±lÄ±ÄŸÄ±nÄ± dÃ¶ner, yoksa anahtarÄ±n kendisini dÃ¶ner
    try:
        return therapy_data[data_key].get(lang, therapy_data[data_key]["en"])
    except KeyError:
        return "Data not found."

# KullanÄ±m Ã¶rneÄŸi
selected_lang = "tr" # Bu deÄŸer kullanÄ±cÄ± arayÃ¼zÃ¼nden dinamik gelecek
print(f"EVEYES 360 Terapi Notu: {get_description('hicaz_desc', selected_lang)}")

import math
import json
import os
SETTINGS_FILE = 'settings.json'

def save_settings(hospital, doctor, contact):
    data = {"hospital": hospital, "doctor": doctor, "contact": contact}
    with open(SETTINGS_FILE, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=4)

def load_settings():
    if os.path.exists(SETTINGS_FILE):
        with open(SETTINGS_FILE, 'r', encoding='utf-8') as f:
            return json.load(f)
    return None

def analyze_bia(resistance, reactance):
    """
    BIA verilerini analiz eder ve Faz AÃ§Ä±sÄ±nÄ± hesaplar.
    DÃ¼ÅŸÃ¼k Faz AÃ§Ä±sÄ± hÃ¼cresel bozulma ve Ã¶dem iÅŸaretidir.
    """
    # Faz AÃ§Ä±sÄ± Hesaplama (Radyan -> Derece dÃ¶nÃ¼ÅŸÃ¼mÃ¼ ile)
    phase_angle = math.degrees(math.atan(reactance / resistance))

    # Analiz sonuÃ§larÄ±
    status = ""
    suggested_key = ""

    if phase_angle < 5.0:
        status = "YÃ¼ksek Ã–dem Riski / HÃ¼cresel ZayÄ±flÄ±k"
        suggested_key = "hicaz_desc" # SelÃ§uklu tÄ±bbÄ±na gÃ¶re Ã¶dem atÄ±cÄ± makam
    else:
        status = "SaÄŸlÄ±klÄ± HÃ¼cre BÃ¼tÃ¼nlÃ¼ÄŸÃ¼"
        suggested_key = "rast_desc"

    return round(phase_angle, 2), status, suggested_key

# Ã–rnek Test: Rezistans=450, Reaktans=35 olan bir hasta iÃ§in
pa, durum, tavsiye_anahtari = analyze_bia(450, 35)

print(f"Faz AÃ§Ä±sÄ±: {pa}Â°")
print(f"Durum: {durum}")
print(f"ReÃ§ete: {get_description(tavsiye_anahtari, 'tr')}")

import math
class Patient:
    def __init__(self, tckn, name, reason):
        self.tckn = tckn
        self.name = name
        self.reason = reason

class EVEYES360_System:
    def __init__(self):  # EÄŸer parantez iÃ§inde isim varsa onu sil, boÅŸ kalsÄ±n
        # 1. Ã–nce ayarlarÄ± dosyadan yÃ¼klemeyi dene
        self.status_db = {
    "kritik": {
        "tr": "Kritik (Ã–dem SaptandÄ±)",
        "en": "Critical (Edema Detected)",
        "ar": "Ø­Ø±Ø¬ (ØªÙ… Ø§ÙƒØªØ´Ø§Ù ÙˆØ°Ù…Ø©)",
        "ru": "ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ (ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½ Ğ¾Ñ‚ĞµĞº)"
    },
    "normal": {
        "tr": "Normal (HÃ¼cresel Denge)",
        "en": "Normal (Cellular Balance)",
        "ar": "Ø·Ø¨ÙŠØ¹ÙŠ (Ø§Ù„ØªÙˆØ§Ø²Ù† Ø§Ù„Ø®Ù„ÙˆÙŠ)",
        "ru": "ĞĞ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ (ĞšĞ»ĞµÑ‚Ğ¾Ñ‡Ğ½Ğ¾Ğµ Ñ€Ğ°Ğ²Ğ½Ğ¾Ğ²ĞµÑĞ¸Ğµ)"
    }}
        settings = load_settings()
        
        if settings:
            # EÄŸer settings.json varsa ismi oradan al
            self.hospital_name = settings['hospital']
            self.doctor = settings['doctor']
            self.contact = settings['contact']
        else:
            # EÄŸer dosya yoksa varsayÄ±lan bir isim ata
            self.hospital_name = "EVEYES 360 Merkezi"
            self.doctor = "Bilinmiyor"
            self.contact = "-"
            
        # Buraya kendi therapy_db sÃ¶zlÃ¼ÄŸÃ¼nÃ¼ eklemeyi unutma
        # DOÄRU YAZIM (Dictionary):
        self.therapy_db = {
        "hicaz_desc": {  # BurasÄ± iki nokta olmalÄ±, virgÃ¼l deÄŸil!
        "tr": "Hicaz makamÄ±: Ã–dem atar.",
        "en": "Hicaz maqam: Reduces edema."
    },
        "rast_desc": {
        "tr": "Rast makamÄ±: NeÅŸe verir.",
        "en": "Rast maqam: Gives joy."
    } }
       
        
    """def __init__(self, hospital_name):
        self.hospital_name = hospital_name  # Kaydedilen hastane adÄ±
        self.therapy_db = {
            "hicaz_desc": {
                "tr": "Hicaz makamÄ±: Ã–dem atar, dinlendirir.",
                "en": "Hicaz maqam: Reduces edema, relaxes.",
                "ar": "Ù…Ù‚Ø§Ù… Ø§Ù„Ø­Ø¬Ø§Ø²: ÙŠÙ‚Ù„Ù„ Ø§Ù„ÙˆØ°Ù…Ø©ØŒ ÙŠØ±ÙŠØ­."
            },
            "rast_desc": {
                "tr": "Rast makamÄ±: Kemik saÄŸlÄ±ÄŸÄ± ve neÅŸe verir.",
                "en": "Rast maqam: Bone health and joy.",
                "ar": "Ù…Ù‚Ø§Ù… Ø§Ù„Ø±Ø³Øª: ØµØ­Ø© Ø§Ù„Ø¹Ø¸Ø§Ù… ÙˆØ§Ù„Ø¨Ù‡Ø¬Ø©."
            }
        }"""

    def calculate_phase_angle(self, resistance, reactance):
        # Bilimsel Faz AÃ§Ä±sÄ± FormÃ¼lÃ¼: arctan(Xc/R) * (180/pi)
        pa = math.degrees(math.atan(reactance / resistance))
        return round(pa, 2)

    def generate_report(self, patient, resistance, reactance, lang="tr"):
        # 1. HesaplamayÄ± yapÄ±yoruz
        pa = self.calculate_phase_angle(resistance, reactance)
        
        # 2. Terminale anlÄ±k Ã§Ä±ktÄ± veriyoruz (Takip nedenini buraya ekledik)
        print(f"HASTA: {patient.name}")
        print(f"TAKÄ°P NEDENÄ°: {patient.reason}") 
        
        # Ã–nce hangi anahtarlarÄ± (key) kullanacaÄŸÄ±mÄ±zÄ± belirliyoruz
        if pa < 5.0:
            recete_key = "hicaz_desc"
            status_key = "kritik" if pa < 5.0 else "normal"
        else:
            recete_key = "rast_desc"
            status_key = "normal"

        # ÅÄ°MDÄ° SÄ°HÄ°R BURADA: MesajlarÄ± sÃ¶zlÃ¼kten (DB) tek seferde Ã§ekiyoruz
        # Bu satÄ±rlar sayesinde 100 dil bile olsa kod deÄŸiÅŸmez!
        durum = self.status_db[status_key].get(lang, self.status_db[status_key]["en"])
        terapi = self.therapy_db[recete_key].get(lang, self.therapy_db[recete_key]["en"])

        # 4. TÃ¼m veriyi bir sÃ¶zlÃ¼kte topluyoruz (Rapor Ã§Ä±ktÄ±sÄ± iÃ§in)
        report = {
            "hospital": self.hospital_name,
            "patient": patient.name,    # patient_name yerine patient.name yaptÄ±k
            "reason": patient.reason,   # Takip nedenini rapora ekledik
            "phase_angle": pa,
            "status": durum,
            "therapy": self.therapy_db[recete_key].get(lang, self.therapy_db[recete_key]["en"])}
        return report
    
# 1. Hastane adÄ±nÄ± sisteme kaydediyoruz
my_app = EVEYES360_System()

# 2. Yeni bir hasta verisi geldiÄŸini varsayalÄ±m (BIA Ã¶lÃ§Ã¼mÃ¼: R=500, Xc=30)
# Åimdi bu paketi (yeni_hasta) fonksiyona gÃ¶nderiyoruz
yeni_hasta = Patient("12345678901", "Ahmet YÄ±lmaz", "Kalp YetmezliÄŸi - Ã–dem Takibi")
patient_report = my_app.generate_report(yeni_hasta, 500, 30, lang="tr")

# 3. Sonucu yazdÄ±ralÄ±m
print(f"--- {patient_report['hospital']} RAPORU ---")
print(f"Hasta: {patient_report['patient']}")
print(f"Takip Nedeni: {patient_report['reason']}") # Bunu eklemeyi unutma
print(f"BIA Faz AÃ§Ä±sÄ±: {patient_report['phase_angle']}Â°")
print(f"TeÅŸhis: {patient_report['status']}")
print(f"Ã–nerilen Tedavi: {patient_report['therapy']}")

import math

class EVEYES360_Biosonology:
    def __init__(self, hospital_name):
        self.hospital_name = hospital_name
        # Mood bozukluklarÄ± ve BIA verilerine gÃ¶re makam eÅŸleÅŸmeleri
        self.makam_rehberi = {
            "dÃ¼sÃ¼kh_faz_acisi": {
                "makam": "Hicaz",
                "etki": "Ã–dem atÄ±cÄ± ve idrar yollarÄ± Ã¼zerinde etkili. Biosonology verisine gÃ¶re hÃ¼cre dÄ±ÅŸÄ± suyun atÄ±lmasÄ±nÄ± destekler.",
                "mood": "Anksiyete azaltÄ±cÄ±"
            },
            "yuksek_stres": {
                "makam": "Neva",
                "etki": "GevÅŸetici ve yatÄ±ÅŸtÄ±rÄ±cÄ±. Ruhsal dengeyi saÄŸlar.",
                "mood": "Depresyon ve keder karÅŸÄ±tÄ±"
            },
            "genel_denge": {
                "makam": "Rast",
                "etki": "Kemik ve kas saÄŸlÄ±ÄŸÄ±. HÃ¼cresel canlÄ±lÄ±ÄŸÄ± (vibrasyon) artÄ±rÄ±r.",
                "mood": "NeÅŸe ve huzur verici"
            }
        }

    def analiz_et(self, pa_degeri, mood_notu=""):
        """
        BIA Faz AÃ§Ä±sÄ± ve hastanÄ±n mood durumuna gÃ¶re reÃ§ete yazar.
        """
        print(f"\n--- {self.hospital_name} ANALÄ°Z RAPORU ---")
        
        if pa_degeri < 5.0:
            recete = self.makam_rehberi["dÃ¼sÃ¼kh_faz_acisi"]
            print(f"Biyosonolojik Tespit: HÃ¼cresel titreÅŸim zayÄ±f (Faz AÃ§Ä±sÄ±: {pa_degeri}Â°)")
            print(f"Klinik Durum: Ã–dem ve dÃ¼ÅŸÃ¼k hÃ¼cresel enerji.")
        else:
            recete = self.makam_rehberi["genel_denge"]
            print(f"Biyosonolojik Tespit: HÃ¼cresel titreÅŸim normal (Faz AÃ§Ä±sÄ±: {pa_degeri}Â°)")

        print(f"Ã–nerilen Makam: {recete['makam']}")
        print(f"Psikolojik Etki: {recete['mood']}")
        print(f"AÃ§Ä±klama: {recete['etki']}")
     
    # Fonksiyonu ÅŸÃ¶yle tanÄ±mla:
    def EVEYES360_Therapy(system_object):
    # ... rapor yazdÄ±rma kodlarÄ± ...
        secim = input("\nğŸ‘‰ Bilimsel dayanaklarÄ± okumak ister misiniz? (E/H): ").upper()
        if secim == "E":
        # Burada 'my_app' yerine 'system_object' kullanÄ±yoruz
            print(system_object.get_scientific_article(lang="tr"))

# Sistemi Test Edelim
eveyes = EVEYES360_Biosonology("NIZAMIYE HOSPITAL")

# Diyelim ki BIA Ã¶lÃ§Ã¼mÃ¼ 4.2 Ã§Ä±ktÄ± (DÃ¼ÅŸÃ¼k/Ã–demli)
eveyes.analiz_et(4.2)

class EVEYES360_Therapy:
    def __init__(self, hospital_name):
        self.hospital_name = hospital_name
        # Musiki, Koku ve Biyosonolojik Etki Matrisi
        self.therapy_matrix = {
            "odem_yuksek": {
                "makam": "Hicaz",
                "koku": "GÃ¼l ve Sandal AÄŸacÄ±",
                "etki": "DiÃ¼retik (Ã¶dem atÄ±cÄ±) ve vazodilatÃ¶r etki. HÃ¼cre dÄ±ÅŸÄ± sÄ±vÄ±yÄ± dengeler.",
                "mood": "Anksiyete ve gerginliÄŸi azaltÄ±r."
            },
            "stres_depresyon": {
                "makam": "Neva",
                "koku": "Lavanta ve Yasemin",
                "etki": "Kortizol baskÄ±layÄ±cÄ±. HÃ¼cre zarÄ±nÄ± strese karÅŸÄ± korur (BIA Faz AÃ§Ä±sÄ±nÄ± stabilize eder).",
                "mood": "Melankoli ve kederi daÄŸÄ±tÄ±r."
            },
            "enerji_dusuk": {
                "makam": "Rast",
                "koku": "Buhur ve Ud",
                "etki": "HÃ¼cresel vibrasyonu artÄ±rÄ±r. Kemik-kas sistemini uyarÄ±r.",
                "mood": "YaÅŸama sevinci ve zindelik verir."
            }
        }
        
        
    # 2. KullanÄ±cÄ±ya sor
    secim = input("\nğŸ‘‰ Bilimsel dayanaklarÄ± ve akademik makaleyi okumak ister misiniz? (E/H): ").upper()

    if secim == "E":
        print("\n" + "="*70)
        print(f"\n{my_app.quick_info['tr']}")
        print("EVEYES 360 - AKADEMÄ°K YAYIN")
        print("="*70)
    # Daha Ã¶nce yazdÄ±ÄŸÄ±mÄ±z dosyadan okuma fonksiyonu:
        print(my_app.get_scientific_article(lang="tr"))
    else:
        print("\nSaÄŸlÄ±klÄ± gÃ¼nler dileriz!")
        
        
    def recete_olustur(self, faz_acisi, mood_notu=""):
        
        self.scientific_insight = {
            "tr": {
            "title": "BÄ°LÄ°MSEL DÄ°PNOT: BÄ°YOSONOLOJÄ° VE SELÃ‡UKLU TIBBI",
            "content": "BURAYA KONTENT GELECEK HÃ¼creler ses dalgalarÄ±na mekanik tepkiler verir. Biyosonoloji, hÃ¼cresel vibrasyonun BIA deÄŸerleriyle (Faz AÃ§Ä±sÄ±) doÄŸrudan iliÅŸkili olduÄŸunu savunur. SelÃ§uklu dÃ¶neminde Gevher Nesibe gibi ÅŸifahanelerde kullanÄ±lan mÃ¼zikoterapi (Hicaz, Rast vb.) ve aromaterapi, bu biyolojik akordu dÃ¼zeltmeyi amaÃ§lar." },
            "en": {
            "title": "SCIENTIFIC INSIGHT: BIOSONOLOGY AND SELJUK MEDICINE",
            "content": "Cells respond mechanically to sound waves. Biosonology suggests that cellular vibration is directly linked to BIA values. Music therapy (Maqams) and aromatherapy used in Seljuk-era hospitals like Gevher Nesibe aim to restore this biological harmony."}}
        
        print(f"\n--- {self.hospital_name} REÃ‡ETE SÄ°STEMÄ° ---")
        
        # Karar mekanizmasÄ±
        if faz_acisi < 5.0:
            key = "odem_yuksek"
        elif "uzgun" in mood_notu.lower() or "stres" in mood_notu.lower():
            key = "stres_depresyon"
        else:
            key = "enerji_dusuk"
            
        recete = self.therapy_matrix[key]
        
        print(f"HÃ¼cresel Durum: {'Kritik (Ã–dem)' if key == 'odem_yuksek' else 'Stabil'}")
        print(f"Dinletilecek Makam: {recete['makam']}")
        print(f"Uygulanacak Koku: {recete['koku']}")
        print(f"Biyolojik Etki: {recete['etki']}")
        print(f"Ruhsal Etki: {recete['mood']}")

    def generate_report(self, patient, r, xc, lang="tr"):
        # ... rapor kodlarÄ± ...
        return report

    # EVEYES360_System sÄ±nÄ±fÄ±nÄ±n iÃ§indeki fonksiyonu ÅŸu ÅŸekilde gÃ¼ncelle:
    def get_scientific_article(self, lang="tr"):
        import os
    # DosyanÄ±n tam yolunu belirleyelim
        current_dir = os.path.dirname(os.path.abspath(__file__))
        file_name = os.path.join(current_dir, f"makale_{lang}.txt")
    
        if os.path.exists(file_name):
             with open(file_name, "r", encoding="utf-8") as f:
                return f.read()
                
        else:
            # EÄŸer dosya yoksa kullanÄ±cÄ±yÄ± bilgilendiren kÄ±sa bir Ã¶zet dÃ¶nelim
            if lang == "tr":
                return f"âŒ HATA: {file_name} dosyasÄ± bulunamadÄ±!"

    
    def EVEYES360_Therapy(system_object):
    # Burada raporu oluÅŸturup yazdÄ±rdÄ±ÄŸÄ±n kodlar olmalÄ±
    # Ã–rnek kullanÄ±m:
        yeni_hasta = Patient("12345678901", "Ahmet YÄ±lmaz", "Kalp YetmezliÄŸi")
        report = system_object.generate_report(yeni_hasta, 500, 30, lang="tr")
    
        print(f"--- {report['hospital']} ANALÄ°Z RAPORU ---")
        print(f"Biyosonolojik Tespit: {report['status']}")
    # ... diÄŸer print satÄ±rlarÄ±n ...
    # Fonksiyonu ÅŸÃ¶yle Ã§aÄŸÄ±r:
    # 1. Ã–nce sistemi baÅŸlat
    my_app = EVEYES360_System()

    # 2. Sonra fonksiyonu Ã§alÄ±ÅŸtÄ±r (NameError almamak iÃ§in tanÄ±m yukarÄ±da olmalÄ±)
    EVEYES360_Therapy(my_app)
    # Ä°ÅTE BURADA SORUYU SORUYORUZ:
    secim = input("\nğŸ‘‰ Bilimsel dayanaklarÄ± ve akademik makaleyi okumak ister misiniz? (E/H): ").upper()
    
    if secim == "E":
        print("\n" + "="*70)
        # SÄ±nÄ±fÄ±n iÃ§indeki o meÅŸhur fonksiyonu Ã§aÄŸÄ±rÄ±yoruz
        print(system_object.get_scientific_article(lang="tr"))
        print("="*70)

# Test Edelim
terapi_merkezi = EVEYES360_Therapy("NIZAMIYE HOSPITAL")

# Ã–rnek: Faz aÃ§Ä±sÄ± 4.8 olan ve anksiyete yaÅŸayan bir hasta
terapi_merkezi.recete_olustur(4.8, "Hasta kendini Ã§ok gergin ve huzursuz hissediyor.")

